"use strict";(()=>{var e={};e.id=356,e.ids=[356],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},6162:e=>{e.exports=require("stream")},1764:e=>{e.exports=require("util")},8678:e=>{e.exports=import("pg")},6967:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>c,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>d});var a=t(9303),s=t(8716),o=t(670),i=t(8454),u=e([i]);i=(u.then?(await u)():u)[0];let p=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/user/route",pathname:"/api/user",filename:"route",bundlePath:"app/api/user/route"},resolvedPagePath:"/workspaces/EvansSarmLab/src/app/api/user/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:h}=p,m="/api/user/route";function c(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:d})}n()}catch(e){n(e)}})},8454:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{GET:()=>u,PUT:()=>c,dynamic:()=>p,revalidate:()=>l});var a=t(7070),s=t(5748),o=t(8657),i=e([s]);s=(i.then?(await i)():i)[0];let p="force-dynamic",l=0;async function u(e){try{let r=e.headers.get("authorization"),{userId:t}=(0,o.AY)(r),n=(0,s.Mj)(),i=await n.query("SELECT id, email, first_name, last_name, phone, created_at FROM users WHERE id = $1",[t]);if(0===i.rows.length)return a.NextResponse.json({error:"User not found"},{status:404});let u=i.rows[0];return a.NextResponse.json({user:{id:u.id,email:u.email,firstName:u.first_name,lastName:u.last_name,phone:u.phone,createdAt:u.created_at}})}catch(e){return console.error("User GET error:",e),a.NextResponse.json({error:"Failed to fetch user"},{status:500})}}async function c(e){try{let r=e.headers.get("authorization"),{userId:t}=(0,o.AY)(r),{firstName:n,lastName:i,phone:u}=await e.json(),c=(0,s.Mj)();return await c.query("UPDATE users SET first_name = $1, last_name = $2, phone = $3 WHERE id = $4",[n,i,u||null,t]),a.NextResponse.json({success:!0})}catch(e){return console.error("User PUT error:",e),a.NextResponse.json({error:"Failed to update user"},{status:500})}}n()}catch(e){n(e)}})},8657:(e,r,t)=>{t.d(r,{Oe:()=>p,RA:()=>u,AY:()=>l,c_:()=>c});var n=t(1482),a=t.n(n);let s=require("bcrypt");var o=t.n(s);let i=process.env.JWT_SECRET||"fallback-secret-key";function u(e){return a().sign(e,i,{expiresIn:"30d"})}async function c(e){return o().hash(e,10)}async function p(e,r){return o().compare(e,r)}function l(e){return function(e){try{return a().verify(e,i)}catch(e){throw Error("Invalid or expired token")}}(function(e){if(!e||!e.startsWith("Bearer "))throw Error("Authorization token required");return e.split(" ")[1]}(e))}},5748:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.d(r,{Mj:()=>o});var a=t(8678),s=e([a]);a=(s.then?(await s)():s)[0];let i=null;function o(){return i||(i=new a.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1},max:20,idleTimeoutMillis:3e4,connectionTimeoutMillis:2e3})),i}n()}catch(e){n(e)}})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[276,972,482],()=>t(6967));module.exports=n})();